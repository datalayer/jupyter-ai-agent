<!--
  ~ Copyright (c) 2023-2024 Datalayer, Inc.
  ~
  ~ BSD 3-Clause License
-->

[![Datalayer](https://assets.datalayer.tech/datalayer-25.svg)](https://datalayer.io)

[![Become a Sponsor](https://img.shields.io/static/v1?label=Become%20a%20Sponsor&message=%E2%9D%A4&logo=GitHub&style=flat&color=1ABC9C)](https://github.com/sponsors/datalayer)

# ü™ê ü§ñ Jupyter AI Agent

[![Github Actions Status](https://github.com/datalayer/jupyter-ai-agent/workflows/Build/badge.svg)](https://github.com/datalayer/jupyter-ai-agent/actions/workflows/build.yml)
[![PyPI - Version](https://img.shields.io/pypi/v/jupyter-ai-agent)](https://pypi.org/project/jupyter-ai-agent)

*Use Jupyter AI Agent, an AI Agent equipped with tools like 'execute', 'insert_cell', and more, to transform your Jupyter Notebooks into an intelligent, interactive workspace!*

![Jupyter AI Agent](https://assets.datalayer.tech/jupyter-ai-agent/ai-agent-jupyterlab.gif)

```
Jupyter AI Agent <---> JupyterLab
    |            (RTC)
 JNC+JKC

- JNC https://github.com/datalayer/jupyter-nbmodel-client
- JKC https://github.com/datalayer/jupyter-kernel-client
- RTC Real Time Collaboration
```

Jupyter AI Agent empowers **AI** models to **interact** with and **modify Jupyter Notebooks**. The agent is equipped with tools such as adding code cells, inserting markdown cells, executing code, enabling it to modify the notebook comprehensively based on user instructions or by reacting to notebook and kernel events.

This agent is **innovative** as it is designed to **operate on the entire notebook**, not just at the cell level, enabling more comprehensive and seamless modifications.

This powerful functionality is made possible through [jupyter-nbmodel-client](https://github.com/datalayer/jupyter-nbmodel-client) and [jupyter-kernel-client](https://github.com/datalayer/jupyter-kernel-client), enabling interaction with Jupyter Notebooks and Kernels.

[LangChain Agent Framework](https://python.langchain.com/v0.1/docs/modules/agents/how_to/custom_agent/) is used to manage the interactions between the AI model and the tools.

> [!WARNING] 
>
> jupyter-nbmodel-client and jupyter-kernel-client are experimental and under active development.
> Unexpected behavior such as ["Panic Exception"](https://github.com/datalayer/jupyter-nbmodel-client/issues/12) may occur, due to potential issue generated by 3rd party projects.

## Concepts

Deployment modes:

- `In-Kernel`.
- `Out-Kernel`.

Interaction modes:

- `Ask`.
- `Listen`.

Available Agents:

- `Prompt`.
- `ErrorExplain`.

Model Providers: Jupyter AI Agent currently supports models from Azure OpenAI, read the [documentation](https://learn.microsoft.com/en-us/azure/ai-services/openai) to get the needed credentials.

Build your own agent: TBD

## Usage

To install Jupyter AI Agent, run the following command.

```bash
pip install jupyter_ai_agent
```

### In-Kernel with JupyterLab Example

The Jupyter AI Agent can directly interact with JupyterLab and the modifications made by the Jupyter AI Agent can be seen in real-time thanks to [Jupyter Real Time Collaboration](https://jupyterlab.readthedocs.io/en/stable/user/rtc.html). Make sure you have JupyterLab installed with the Collaboration extension.

```bash
pip install jupyterlab jupyter-collaboration ipykernel matplotlib
```

Start JupyterLab, setting a `port` and a `token` to be reused by the agent, and create a notebook `test.ipynb`.

```bash
jupyter lab --port 8888 --token MY_TOKEN
```

Make sure you have a `.env` file with the following content.

```bash
OPENAI_API_VERSION = ...
AZURE_OPENAI_ENDPOINT = ...
AZURE_OPENAI_API_KEY = ...
```

To use the Jupyter AI Agent, an easy way is to launch a CLI.

```bash
jupyter-ai-agent --url http://localhost:8888 --token MY_TOKEN
```

Execute the following code.

```py
from jupyter_ai_agent.agent import ask_agent

server_url = "http://localhost:8888"
token = "MY_TOKEN"
azure_deployment_name = "gpt-4o-mini" # For example.
notebook_path = "test.ipynb"
agent_type = "prompt"
input = "Create a matplotlib example"

ask_agent(server_url, token, azure_deployment_name, azure_deployment_name, notebook_path, input, agent_type)
```

## Uninstall

To uninstall the agent, execute.

```bash
pip uninstall jupyter_ai_agent
```

## Contributing

### Development install

```bash
# Clone the repo to your local environment
# Change directory to the jupyter_ai_agent directory
# Install package in development mode - will automatically enable
# The server extension.
pip install -e ".[test,lint,typing]"
```

### Running Tests

Install dependencies:

```bash
pip install -e ".[test]"
```

To run the python tests, use:

```bash
pytest
```

### Development uninstall

```bash
pip uninstall jupyter_ai_agent
```

### Packaging the library

See [RELEASE](RELEASE.md)
